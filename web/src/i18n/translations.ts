export const supportedLocales = ['zh', 'en'] as const

export type Locale = (typeof supportedLocales)[number]
export type TranslationValues = Record<string, string | number>

const baseTranslations = {
  en: {
    'app.nav.dashboard': 'Dashboard',
    'app.nav.stats': 'Statistics',
    'app.nav.live': 'Live',
    'app.brand': 'Codex Vibe Monitor',
    'app.logoAlt': 'Codex Vibe Monitor icon',
    'app.language.label': 'Language',
    'app.language.option.en': 'English',
    'app.language.option.zh': '中文',
    'app.language.switcherAria': 'Change language',
    'app.update.available': 'A new version is available:',
    'app.update.current': 'current',
    'app.update.refresh': 'Refresh now',
    'app.update.later': 'Later',
    'app.sse.banner.title': 'Live connection lost',
    'app.sse.banner.description': 'No server events have arrived for over two minutes.',
    'app.sse.banner.duration': 'Offline for {{minutes}}m {{seconds}}s',
    'app.sse.banner.durationChip': 'Offline {{minutes}}m {{seconds}}s',
    'app.sse.banner.retryIn': 'Auto reconnect in {{seconds}}s',
    'app.sse.banner.retryingNow': 'Retrying now…',
    'app.sse.banner.autoDisabled': 'Auto reconnect paused after extended downtime. Click to try again.',
    'app.sse.banner.reconnectButton': 'Reconnect now',
    'app.footer.githubAria': 'Open GitHub repository',
    'app.footer.loadingVersion': 'Loading version…',
    'app.footer.versionLabel': '{{scope}} {{version}}',
    'app.footer.frontendLabel': 'Front-end',
    'app.footer.backendLabel': 'Back-end',
    'app.footer.newVersionAvailable': 'Page has a newer version',
    'app.footer.copyright': '© Codex Vibe Monitor',
    'dashboard.section.summaryTitle': 'Last 24 hours summary',
    'dashboard.section.liveRefreshing': 'Live refresh',
    'dashboard.section.recentLiveTitle': 'Latest {{count}} live records',
    'stats.range.lastHour': 'Past hour',
    'stats.range.today': 'Today',
    'stats.range.lastDay': 'Past day',
    'stats.range.thisWeek': 'This week',
    'stats.range.lastWeek': 'Past 7 days',
    'stats.range.thisMonth': 'This month',
    'stats.range.lastMonth': 'Past month',
    'stats.bucket.eachMinute': 'Each minute',
    'stats.bucket.each5Minutes': 'Every 5 minutes',
    'stats.bucket.each15Minutes': 'Every 15 minutes',
    'stats.bucket.each30Minutes': 'Every 30 minutes',
    'stats.bucket.eachHour': 'Each hour',
    'stats.bucket.each6Hours': 'Every 6 hours',
    'stats.bucket.each12Hours': 'Every 12 hours',
    'stats.bucket.eachDay': 'Each day',
    'stats.title': 'Statistics',
    'stats.subtitle': 'Select time range and aggregation granularity',
    'stats.settlementHour': 'Settlement hour',
    'stats.trendTitle': 'Trend',
    'stats.successFailureTitle': 'Success vs failures',
    'stats.errors.title': 'Error reasons',
    'quota.title': 'Quota overview',
    'quota.subscription': 'Subscription: {{name}}',
    'quota.status.active': 'Active',
    'quota.labels.usageRate': 'Usage rate',
    'quota.labels.used': 'Used',
    'quota.labels.remaining': 'Remaining quota',
    'quota.labels.nextReset': 'Next reset',
    'quota.status.expired': 'Expired',
    'quota.status.expireInDays': 'Expires in {{count}} days',
    'quota.status.expireInHours': 'Expires in {{count}} hours',
    'quota.status.expireInMinutes': 'Expires in {{count}} minutes',
    'quota.status.expireAt': 'Expires at {{time}}',
    'quota.status.expireUnknown': 'Expires at —',
    'live.summary.current': 'Current window',
    'live.summary.30m': '30 minutes',
    'live.summary.1h': '1 hour',
    'live.summary.1d': '1 day',
    'live.summary.title': 'Live summary',
    'live.chart.title': 'Live charts',
    'live.window.label': 'Window size',
    'live.option.records': '{{count}} records',
    'live.latest.title': 'Latest records',
    'metric.totalCount': 'Calls',
    'metric.totalCost': 'Cost',
    'metric.totalTokens': 'Tokens',
    'legend.low': 'Low',
    'legend.high': 'High',
    'calendar.title': 'Usage activity',
    'calendar.metricsToggleAria': 'Switch metric',
    'calendar.valueSeparator': ': ',
    'calendar.timeZoneLabel': 'Timezone',
    'calendar.weekday.sun': 'Sun',
    'calendar.weekday.mon': 'Mon',
    'calendar.weekday.tue': 'Tue',
    'calendar.weekday.wed': 'Wed',
    'calendar.weekday.thu': 'Thu',
    'calendar.weekday.fri': 'Fri',
    'calendar.weekday.sat': 'Sat',
    'calendar.monthLabel': '{{year}}/{{month}}',
    'heatmap.title': 'Last 7 days heatmap',
    'heatmap24h.title': 'Last 24h heatmap (10-min)',
    'heatmap.metricsToggleAria': 'Switch metric',
    'heatmap.noData': 'No data yet',
    'table.loadError': 'Failed to load records: {{error}}',
    'table.loadingRecordsAria': 'Loading records',
    'table.noRecords': 'No records yet.',
    'table.column.time': 'Time',
    'table.column.model': 'Model',
    'table.column.status': 'Status',
    'table.column.inputTokens': 'Input',
    'table.column.outputTokens': 'Output',
    'table.column.totalTokens': 'Total tokens',
    'table.column.costUsd': 'Cost (USD)',
    'table.column.error': 'Error',
    'table.status.success': 'Success',
    'table.status.failed': 'Failed',
    'table.status.running': 'Running',
    'table.status.pending': 'Pending',
    'table.status.unknown': 'Unknown',
    'table.errorDetailsTitle': 'Error details',
    'table.errorDetailsEmpty': 'No error details available.',
    'stats.cards.loadError': 'Failed to load stats: {{error}}',
    'stats.cards.totalCalls': 'Total calls',
    'stats.cards.success': 'Success',
    'stats.cards.failures': 'Failures',
    'stats.cards.totalCost': 'Total cost',
    'stats.cards.totalTokens': 'Total tokens',
    'chart.loading': 'Loading',
    'chart.loadingDetailed': 'Loading chart',
    'chart.noDataRange': 'No data for selected range.',
    'chart.noDataPoints': 'No data points yet.',
    'chart.totalTokens': 'Total tokens',
    'chart.totalCost': 'Cost (USD)',
    'chart.totalCount': 'Calls',
    'unit.calls': 'calls',
    'quota.status.expired.badge': 'Expired',
  },
  zh: {
    'app.nav.dashboard': '总览',
    'app.nav.stats': '统计',
    'app.nav.live': '实况',
    'app.brand': 'Codex Vibe Monitor',
    'app.logoAlt': 'Codex Vibe Monitor 图标',
    'app.language.label': '语言',
    'app.language.option.en': 'English',
    'app.language.option.zh': '中文',
    'app.language.switcherAria': '切换语言',
    'app.update.available': '有新版本可用：',
    'app.update.current': '当前',
    'app.update.refresh': '立即刷新',
    'app.update.later': '稍后',
    'app.sse.banner.title': '实时连接已中断',
    'app.sse.banner.description': '已超过 2 分钟未收到服务器事件。',
    'app.sse.banner.duration': '已掉线 {{minutes}} 分 {{seconds}} 秒',
    'app.sse.banner.durationChip': '已掉线 {{minutes}}分{{seconds}}秒',
    'app.sse.banner.retryIn': '{{seconds}} 秒后自动重连',
    'app.sse.banner.retryingNow': '正在尝试重连…',
    'app.sse.banner.autoDisabled': '长时间掉线后已暂停自动重连，请手动重试。',
    'app.sse.banner.reconnectButton': '立即重连',
    'app.footer.githubAria': '打开 GitHub 仓库',
    'app.footer.loadingVersion': '版本加载中…',
    'app.footer.versionLabel': '{{scope}} {{version}}',
    'app.footer.frontendLabel': '前端',
    'app.footer.backendLabel': '后端',
    'app.footer.newVersionAvailable': '页面有新版本',
    'app.footer.copyright': '© Codex Vibe Monitor',
    'dashboard.section.summaryTitle': '最近 24 小时统计',
    'dashboard.section.liveRefreshing': '实时刷新',
    'dashboard.section.recentLiveTitle': '最近 {{count}} 条实况',
    'stats.range.lastHour': '最近 1 小时',
    'stats.range.today': '今日',
    'stats.range.lastDay': '最近 1 天',
    'stats.range.thisWeek': '本周',
    'stats.range.lastWeek': '最近 7 天',
    'stats.range.thisMonth': '本月',
    'stats.range.lastMonth': '最近 1 个月',
    'stats.bucket.eachMinute': '每分钟',
    'stats.bucket.each5Minutes': '每 5 分钟',
    'stats.bucket.each15Minutes': '每 15 分钟',
    'stats.bucket.each30Minutes': '每 30 分钟',
    'stats.bucket.eachHour': '每小时',
    'stats.bucket.each6Hours': '每 6 小时',
    'stats.bucket.each12Hours': '每 12 小时',
    'stats.bucket.eachDay': '每天',
    'stats.title': '统计',
    'stats.subtitle': '选择时间范围与聚合粒度',
    'stats.settlementHour': '结算小时',
    'stats.trendTitle': '趋势',
    'stats.successFailureTitle': '成功/失败次数',
    'stats.errors.title': '错误原因分布',
    'quota.title': '配额概览',
    'quota.subscription': '订阅：{{name}}',
    'quota.status.active': '正常使用',
    'quota.labels.usageRate': '使用率',
    'quota.labels.used': '已使用',
    'quota.labels.remaining': '剩余额度',
    'quota.labels.nextReset': '下次重置',
    'quota.status.expired': '已到期',
    'quota.status.expireInDays': '到期：剩余{{count}}天',
    'quota.status.expireInHours': '到期：剩余{{count}}小时',
    'quota.status.expireInMinutes': '到期：剩余{{count}}分钟',
    'quota.status.expireAt': '到期：{{time}}',
    'quota.status.expireUnknown': '到期：—',
    'live.summary.current': '当前窗口',
    'live.summary.30m': '30 分钟',
    'live.summary.1h': '1 小时',
    'live.summary.1d': '1 天',
    'live.summary.title': '实时统计',
    'live.chart.title': '实时图表',
    'live.window.label': '窗口大小',
    'live.option.records': '{{count}} 条记录',
    'live.latest.title': '最新记录',
    'metric.totalCount': '次数',
    'metric.totalCost': '金额',
    'metric.totalTokens': 'Tokens',
    'legend.low': '低',
    'legend.high': '高',
    'calendar.title': '使用活动',
    'calendar.metricsToggleAria': '统计指标切换',
    'calendar.valueSeparator': '：',
    'calendar.timeZoneLabel': '时区',
    'calendar.weekday.sun': '日',
    'calendar.weekday.mon': '一',
    'calendar.weekday.tue': '二',
    'calendar.weekday.wed': '三',
    'calendar.weekday.thu': '四',
    'calendar.weekday.fri': '五',
    'calendar.weekday.sat': '六',
    'calendar.monthLabel': '{{year}}年{{month}}月',
    'heatmap.title': '最近 7 天活动图',
    'heatmap24h.title': '最近 24 小时热点图（10 分钟）',
    'heatmap.metricsToggleAria': '指标切换',
    'heatmap.noData': '暂无数据',
    'table.loadError': '加载记录失败：{{error}}',
    'table.loadingRecordsAria': '正在加载记录',
    'table.noRecords': '暂无记录。',
    'table.column.time': '时间',
    'table.column.model': '模型',
    'table.column.status': '状态',
    'table.column.inputTokens': '输入',
    'table.column.outputTokens': '输出',
    'table.column.totalTokens': '总 Tokens',
    'table.column.costUsd': '成本（美元）',
    'table.column.error': '错误',
    'table.status.success': '成功',
    'table.status.failed': '失败',
    'table.status.running': '运行中',
    'table.status.pending': '排队中',
    'table.status.unknown': '未知',
    'table.errorDetailsTitle': '错误详情',
    'table.errorDetailsEmpty': '暂无错误详情。',
    'stats.cards.loadError': '加载统计失败：{{error}}',
    'stats.cards.totalCalls': '调用总数',
    'stats.cards.success': '成功',
    'stats.cards.failures': '失败',
    'stats.cards.totalCost': '总成本',
    'stats.cards.totalTokens': '总 Tokens',
    'chart.loading': '加载中',
    'chart.loadingDetailed': '正在加载图表',
    'chart.noDataRange': '所选范围暂无数据。',
    'chart.noDataPoints': '暂无数据点。',
    'chart.totalTokens': '总 Tokens',
    'chart.totalCost': '成本（美元）',
    'chart.totalCount': '次数',
    'unit.calls': '次',
    'quota.status.expired.badge': '已到期',
  },
} as const

type BaseTranslations = typeof baseTranslations
type TranslationKey = keyof BaseTranslations['en']

export const translations: Record<Locale, Record<TranslationKey, string>> = baseTranslations

export type { TranslationKey }

export const FALLBACK_LOCALE: Locale = 'en'

export function formatTranslation(template: string, values?: TranslationValues) {
  if (!values) return template
  return template.replace(/\{\{\s*(\w+)\s*\}\}/g, (_, key: string) => {
    const value = values[key]
    return value === undefined || value === null ? '' : String(value)
  })
}
